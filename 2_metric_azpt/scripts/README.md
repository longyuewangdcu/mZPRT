# mZPRT
Multi-domain Zero Pronoun Recovery and Translation Dataset   
---

### Alignment Scripts
    .
    ├── fastAlign               # scripts for fastAlign training and apply to testsets
    ├── GIZA                    # scripts for GiZA training and apply to testsets
    └── README.md   
---

### Preparation
1. Our aZPT method in related to the alignment file as follow:   
```
  # source 手动 还是 自动 ， 你 确定 离合 掌握 好 了 ？
  # target manual or automatic , make sure the clutch is under control ?
  # Alignments: 0-0 1-1 2-2 3-3 5-5 6-7 10-11
```
2. The alignment file could be generated by fastAlign or GIZA toolkits:   
   2.1. Install [fastAlign](https://github.com/clab/fast_align)   
```bash
git clone https://github.com/clab/fast_align.git
sudo apt-get install libgoogle-perftools-dev libsparsehash-dev
mkdir build
cd build
cmake ..
make
```
  2.2 Install [GIZA++](https://github.com/moses-smt/giza-pp)   
```bash
https://github.com/moses-smt/giza-pp.git
cd GIZA++-v2 
make
cd ../mkcls-v2
make
```



### Usage
#### Trainig
Take training corpus, train.tok.zh and train.tok.en as an example:
1. fastAlign:
```bash
    sh fastAlign/fastAlign.sh train.tok.zh train.tok.en output_dir
    # once you finish the training, the output files should be in output_dir
    # corpus.zh-en is training corpus for fastalign, format is 'Chinese ||| English'
    # forward.table,forward.aligned,forward.err
    # same as inverse direction
```
2. GIZA:
```bash
    sh GIZA/train_giza.sh /home/user/output_dir /home/user/data/train.tok
    # there two step for training, 1) preparing dataset 2) training GIZA
```
However, sometime the vocab file is wrong when we using the palin2snt.out script provided by GIZA. We suggest to prepare the dataset with [Mosesdecoder](http://www.statmt.org/moses/):   
```bash
   #first we should modify the option in GIZA/train_smt.sh
   sh ./GIZA/train_smt.sh
   # this will generates the preprocessed data in $ROOT/train/corpus
   # then run the second step in train_giza.sh
   # finally, there are *.a3.*,*.D3.* .... in the output file
```

#### Apply to testsets
1. fastAlign:   
```bash
  # Plz modify the option($File) in the bash file, it means where to save your output.
  sh fastAlign/apply_fast_align.sh source target bitext_name(output) output_name
```

2. GIZA:
```bash
  sh GIZA/force_align.sh trained_path(output_dir_of_training) source target output_dir output_prefix
  # finally we get a output file: aligned.intersect
```
       
